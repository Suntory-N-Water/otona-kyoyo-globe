## プロジェクト概要

YouTubeチャンネル「大人の教養TV」が動画内で訪れた世界・日本各地のロケ地を、インタラクティブな3D地球儀から探索できる非公式Webサイト。ファンが「あーこんなところ行ってたな」と懐かしみ・再発見するための体験を提供する。

## 意思決定の背景

**なぜこのサイトを作るか**
大人の教養TVのファンが「あーこんなところ行ってたな」と懐かしめる体験を提供したい。新規ユーザー獲得ではなく、既存ファンの再発見が目的。

**なぜ地球儀か**
ロケ地という地理的なコンテンツを一番直感的かつカッコよく見せられるUIが地球儀だから。

**なぜglobe.glでズームし続けない設計にしたか**
ズームするほどテクスチャのピンボケが激しくなる技術的限界がある。またこのサイトの主役は「地図の精度」ではなく「飛ぶ気持ちよさ」であるため、地球儀はロケ地を探す場所、地図は動画を選ぶ場所として役割を明確に分けることにした。Google Maps APIはページロードごとに課金が発生しアクセス急増時のマネーリスクがあるため採用しない。

**なぜ日本だけ特別扱いするか**
チャンネルが日本ロケを大量にやっており、全国表示にすると地図がピンだらけになって体験が損なわれるから。日本は周辺エリアに絞り、海外は広域で見せる非対称な設計が最も体験として自然。

**なぜ初期位置を糸島市にするか**
チャンネルの拠点が福岡県糸島市であり、ファンへのこだわりとして意図的に仕込む。気づいた人が嬉しくなる細部。

## ターゲットユーザー

チャンネルの既存ファン。新規ユーザー獲得は目的としない。

**ペルソナ：ヒロシ(42歳・男性・メーカー勤務の中間管理職)**

- 性格：知的好奇心が強く、週末にドキュメンタリーやYouTubeで歴史・政治系の動画をよく見る。仕事は忙しいが「ちゃんと世界を知っておきたい」という意識がある。
- 大人の教養TVとの関係：1年以上チャンネルを見ており、好きな動画は複数ある。セルビア回やギリシャ回が特に印象に残っている。
- このサイトでの行動：「そういえばあの動画どこのロケだっけ」と地球儀を回しながら懐かしむ。知らなかった動画を地図から発見することもある。
- デバイス：平日は会社PCか電車でスマホ、週末は自宅のMacBook。

## ユーザー体験フロー

1. サイトを開くと宇宙空間に浮かぶリアルな地球儀が回転している(初期正面は糸島市)
2. 初回訪問時のみ「ピンをクリックして動画の場所へ飛ぼう」というガイドがさりげなく表示され、操作すると消える
3. ユーザーが地球儀を自由に回転させてピンを探す
4. ピンをクリックすると地球儀が自転し、そのピンを正面に向けてからビュンと地図画面に切り替わる
5. 地図画面でピンをクリックすると縦パネルのオーバーレイで動画一覧が表示される
6. サムネをクリックするとYouTubeに遷移する
7. 画面左上の「← 地球儀に戻る」を押すと、直前に見ていた地点が正面に来た状態で地球儀に戻る

## 地図画面の設計

**役割分担**
- 地球儀：ロケ地を探す・発見する場所
- 地図画面：動画を選ぶ場所

地球儀上でピンを押したらビュンと地図画面に切り替わる。地球儀上でズームし続ける設計は採用しない。

**地図ライブラリ**
LeafletまたはMapboxを使用。globe.glは地球儀専用として使い続ける。

**戻る導線**
ブラウザバックに依存しない。画面左上に「← 地球儀に戻る」を常時表示し、押したら直前に見ていた地点が正面に来た状態で地球儀に戻れる。「どこにいたか」を記憶して戻ることが重要。

**表示範囲：日本の場合**
押したピンを中心に周辺エリアだけ表示する。全国表示にはしない。まず150km固定で実装し、破綻するケースが出たら都道府県境界データを使った対応に切り替える段階的アプローチをとる。

**表示範囲：海外の場合**
押した国を中心に周辺国のピンも全部表示する(例：セルビアを押したら旧ユーゴ圏のピンが一緒に見える)。表示範囲はピンが全部収まるようにfitBoundsで自動調整する。固定範囲にしない理由は、日本のような大国と小国が混在する海外では固定範囲が破綻するから。

## UIデザイン方針

**全体の雰囲気**
宇宙・クール・リアル系。背景は黒〜濃紺の宇宙空間、地球はリアルテクスチャ、ピンは光が滲むグロー系アイコン。

**ピンのビジュアル**
再生数・投稿日をもとにピンのサイズと明るさを変化させる。よく取り上げられた場所が視覚的に際立つようにする。

**日本のピン密集対策**
日本はロケ数が多く地球儀上で密集するため、クラスター型で対応する。遠くから見ると「まとめピン(例：23件)」として表示され、ズームインすると個別ピンに分解される。地図画面に遷移後は150km固定範囲で表示する(地図画面の設計セクション参照)。

**スマホ対応**
レスポンシブ対応 + タッチ操作対応(指で地球儀を回転できる)。PWA対応は行わない。

## 技術スタック

| 役割           | 技術                                       |
| -------------- | ------------------------------------------ |
| フロントエンド | Vite + React                               |
| 地球儀         | globe.gl                                   |
| ホスティング   | Vercel(git pushで自動デプロイ)           |
| データ         | 静的JSON(サーバーレス)                   |
| OGP            | index.htmlに静的metaタグを1枚配置、SPA構成 |

Next.jsは不要。globe.glはCanvasレンダリングのためSSR・SSGの恩恵がなく、Vite + ReactのSPAで十分。

## データ構成

**JSONスキーマ(設計時に確定させること)**

動画1件あたり以下の情報を持つ。スキーマは最初に確定し、後から構造を変えない。

```json
{
  "videoId": "YouTubeの動画ID",
  "title": "動画タイトル",
  "thumbnailUrl": "サムネURL",
  "publishedAt": "投稿日(ISO 8601)",
  "viewCount": 123456,
  "locations": [
    {
      "name": "地名(正規化済み)",
      "lat": 44.8176,
      "lng": 20.4569,
      "confidenceScore": 0.95,
      "needsReview": false
    }
  ]
}
```

**confidenceScore**：Places APIの取得結果に対する信頼スコア。低スコアのものだけ人が確認・修正する運用にし、全件確認のコストを避ける。

**needsReview**：スコアが閾値以下の場合にtrueを立てるフラグ。JSONを直接編集して修正後にfalseに戻す。

## データ取得パイプライン

GitHub Actionsで定期実行(毎日1回)し、以下のフローで自動処理する。

```
YouTube API(新動画検知・文字起こし取得)
↓
AIで地名抽出・名寄せ(表記ゆれ・日本語地名の正規化)
↓
Google Places APIで座標取得 + 信頼スコア付与
↓
バリデーション(スキーマ整合性チェック)
↓
通過したもののみJSONに追記してgit push → Vercel自動デプロイ
```

- 動画データは公開後に変わらないため、DBやサーバーは不要
- フロントは常にJSONを読むだけ
- 座標の修正はJSONを直接編集して対応

## 地球儀の初期表示

起動時の正面は福岡県糸島市に固定する。チャンネルの拠点であり、ファンが気づいて嬉しくなる細部として意図的に設定する。

## サイトタイトルの表示

ロード完了直後に「大人の教養TV ロケ地マップ」というタイトルとチャンネルへのリンクを画面隅に小さく常時表示する。サイトの文脈を即座に伝えるための最低限の情報として配置する。

## 同地点に複数動画がある場合のUI

ピンをクリックして該当地点に動画が複数ある場合、縦パネルのオーバーレイで一覧表示する。横スクロールは採用しない。理由は地球儀が主役のサイトであり、縦パネルなら地球儀の上にふわっと重なって閉じたらすぐ地球儀に戻れるため体験が途切れないから。動画が1枚のときも同じUIを使い、枚数によって見た目が変わらないようにする。

## 未解決事項・注意点

- Google Places APIで曖昧な地名(例：「セルビアのあの広場」)が誤ヒットするリスクがある。信頼スコアとneedsReviewフラグで運用でカバーする
- JSONスキーマは実装前に確定させること。後から項目追加するとパイプラインとフロントの両方に影響が出る
